<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å‰ç«¯è¿›é˜¶ç®—æ³•2ï¼šä»Chrome V8æºç çœ‹JavaScriptæ•°ç»„(é™„èµ è…¾è®¯é¢è¯•é¢˜) | duangdongçš„algorithm</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?0088ce24040b03f2947322ab31d23414";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
    <script>
  var _hmt = _hmt || [];
  _hmt.push(['_requirePlugin', 'UrlChangeTracker', {
    shouldTrackUrlChange: function (newPath, oldPath) {
      newPath = newPath.split('#')[0];
      oldPath = oldPath.split('#')[0];
      return newPath != oldPath;
    }}
  ]);
  </script>
    <meta name="description" content="å‰ç«¯ç›¸å…³çŸ¥è¯†å½’çº³æ€»ç»“">
    <meta name="keywords" content="qd-blog,node,vuepress,leetcode,algorithm">
    
    <link rel="preload" href="/assets/css/0.styles.b4a844ec.css" as="style"><link rel="preload" href="/assets/js/app.950eebbc.js" as="script"><link rel="preload" href="/assets/js/2.57da4f88.js" as="script"><link rel="preload" href="/assets/js/1.a76cc220.js" as="script"><link rel="preload" href="/assets/js/29.49b5374e.js" as="script"><link rel="prefetch" href="/assets/js/10.50f73657.js"><link rel="prefetch" href="/assets/js/11.0390ceee.js"><link rel="prefetch" href="/assets/js/12.f88bec36.js"><link rel="prefetch" href="/assets/js/13.963ad03b.js"><link rel="prefetch" href="/assets/js/14.512f15b9.js"><link rel="prefetch" href="/assets/js/15.a674496c.js"><link rel="prefetch" href="/assets/js/16.ed7e507f.js"><link rel="prefetch" href="/assets/js/17.de667ca5.js"><link rel="prefetch" href="/assets/js/18.b44e84af.js"><link rel="prefetch" href="/assets/js/19.5b5ad6a1.js"><link rel="prefetch" href="/assets/js/20.6800493a.js"><link rel="prefetch" href="/assets/js/21.6589052c.js"><link rel="prefetch" href="/assets/js/22.f648d829.js"><link rel="prefetch" href="/assets/js/23.b85d0d4e.js"><link rel="prefetch" href="/assets/js/24.d81147fb.js"><link rel="prefetch" href="/assets/js/25.ed5233ca.js"><link rel="prefetch" href="/assets/js/26.83f1ef57.js"><link rel="prefetch" href="/assets/js/27.2565321e.js"><link rel="prefetch" href="/assets/js/28.e60083e4.js"><link rel="prefetch" href="/assets/js/3.13e892f5.js"><link rel="prefetch" href="/assets/js/30.9ad0e230.js"><link rel="prefetch" href="/assets/js/31.c97534c6.js"><link rel="prefetch" href="/assets/js/32.b90554dc.js"><link rel="prefetch" href="/assets/js/33.9d15b4c0.js"><link rel="prefetch" href="/assets/js/34.297b5f45.js"><link rel="prefetch" href="/assets/js/35.029c4cac.js"><link rel="prefetch" href="/assets/js/36.bc299146.js"><link rel="prefetch" href="/assets/js/37.9068edfd.js"><link rel="prefetch" href="/assets/js/38.8c781d87.js"><link rel="prefetch" href="/assets/js/39.87c06c9c.js"><link rel="prefetch" href="/assets/js/4.5bdb9365.js"><link rel="prefetch" href="/assets/js/40.b05763a5.js"><link rel="prefetch" href="/assets/js/41.447511bf.js"><link rel="prefetch" href="/assets/js/42.cef1f724.js"><link rel="prefetch" href="/assets/js/43.cae02230.js"><link rel="prefetch" href="/assets/js/44.833e4694.js"><link rel="prefetch" href="/assets/js/45.2933ab3e.js"><link rel="prefetch" href="/assets/js/46.1108fab7.js"><link rel="prefetch" href="/assets/js/47.1a5b2293.js"><link rel="prefetch" href="/assets/js/48.3f01058a.js"><link rel="prefetch" href="/assets/js/49.24929fd6.js"><link rel="prefetch" href="/assets/js/5.7c68fdb5.js"><link rel="prefetch" href="/assets/js/50.7e052a76.js"><link rel="prefetch" href="/assets/js/51.ae3eb599.js"><link rel="prefetch" href="/assets/js/52.bab65685.js"><link rel="prefetch" href="/assets/js/53.abacf47c.js"><link rel="prefetch" href="/assets/js/54.9d8ffddf.js"><link rel="prefetch" href="/assets/js/55.ac9707fe.js"><link rel="prefetch" href="/assets/js/56.9a9c42d4.js"><link rel="prefetch" href="/assets/js/57.f4d88e89.js"><link rel="prefetch" href="/assets/js/58.816a3870.js"><link rel="prefetch" href="/assets/js/59.8a6b3c7f.js"><link rel="prefetch" href="/assets/js/6.c8da7ca7.js"><link rel="prefetch" href="/assets/js/7.e4c88d0e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5143d2e0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b4a844ec.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">duangdongçš„algorithm</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/algorithm/" class="nav-link router-link-active">
  æ•°æ®ç»“æ„
</a></div><div class="nav-item"><a href="/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/leetcode-summary/" class="nav-link">
  ç®—æ³•é¢˜
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/algorithm/" class="nav-link router-link-active">
  æ•°æ®ç»“æ„
</a></div><div class="nav-item"><a href="/leetcode/" class="nav-link">
  Leetcode
</a></div><div class="nav-item"><a href="/leetcode-summary/" class="nav-link">
  ç®—æ³•é¢˜
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/algorithm/" aria-current="page" class="sidebar-link">ç®—æ³•ç›¸å…³</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å‰ç«¯å®é™…é¡¹ç›®ä½¿ç”¨</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/algorithm/åŠ¨æ€è§„åˆ’.html" class="sidebar-link">å‰ç«¯ä¹Ÿèƒ½å­¦ç®—æ³•ï¼šç”±æµ…å…¥æ·±è®²è§£åŠ¨æ€è§„åˆ’</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ’åº</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/algorithm/ç”±æµ…å…¥æ·±è®²è§£è´ªå¿ƒç®—æ³•.html" class="sidebar-link">å‰ç«¯ä¹Ÿèƒ½å­¦ç®—æ³•ï¼šç”±æµ…å…¥æ·±è®²è§£è´ªå¿ƒç®—æ³•</a></li><li><a href="/algorithm/ç®€å•å¤ä¹ ä¸‹å‰ç«¯ç®—æ³•å¤æ‚åº¦ç›¸å…³çš„çŸ¥è¯†.html" class="sidebar-link">ç®€å•å¤ä¹ ä¸‹å‰ç«¯ç®—æ³•å¤æ‚åº¦ç›¸å…³çš„çŸ¥è¯†</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ç®—æ³•è¿›é˜¶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/ChromeV8æºç çœ‹JavaScriptæ•°ç»„.html" class="active sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•2ï¼šä»Chrome V8æºç çœ‹JavaScriptæ•°ç»„(é™„èµ è…¾è®¯é¢è¯•é¢˜)</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/DIffç®—æ³•çœ‹ä¸æ‡‚å°±ä¸€èµ·æ¥é”¤æˆ‘.html" class="sidebar-link">DIffç®—æ³•çœ‹ä¸æ‡‚å°±ä¸€èµ·æ¥é”¤æˆ‘</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/Diffç®—æ³•æ ¸å¿ƒåŸç†.html" class="sidebar-link">15å¼ å›¾ï¼Œ20åˆ†é’Ÿåƒé€Diffç®—æ³•æ ¸å¿ƒåŸç†</a></li><li><a href="/algorithm/%E7%AE%97%E6%B3%95%E8%BF%9B%E9%98%B6/" aria-current="page" class="sidebar-link">ç®—æ³•è¿›é˜¶</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/ä¸€çœ‹å°±æ‡‚çš„é˜Ÿåˆ—åŠé…å¥—ç®—æ³•é¢˜.html" class="sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•6ï¼šä¸€çœ‹å°±æ‡‚çš„é˜Ÿåˆ—åŠé…å¥—ç®—æ³•é¢˜</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/ä»æµè§ˆå™¨ç¼“å­˜æ·˜æ±°ç­–ç•¥å’ŒVueçš„keep-aliveå­¦ä¹ LRUç®—æ³•.html" class="sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•3ï¼šä»æµè§ˆå™¨ç¼“å­˜æ·˜æ±°ç­–ç•¥å’ŒVueçš„keep-aliveå­¦ä¹ LRUç®—æ³•</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/åˆ«å†è¯´ä½ ä¸æ‡‚Top-Ké—®é¢˜äº†.html" class="sidebar-link">åˆ«å†è¯´ä½ ä¸æ‡‚Top Ké—®é¢˜äº†</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/å»å¤§å‚é¢è¯•é—®æˆ‘ç®—æ³•.html" class="sidebar-link">å»å¤§å‚é¢è¯•é—®æˆ‘ç®—æ³•ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠï¼Ÿ</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/åŠæ‰“é¢è¯•å®˜ä¹‹æ•°æ®ç»“æ„æ ˆ.html" class="sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•5ï¼šåŠæ‰“é¢è¯•å®˜ä¹‹æ•°æ®ç»“æ„æ ˆï¼ˆ+leetcodeåˆ·é¢˜ï¼‰</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/å †æ’åº.html" class="sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•ï¼šçœ‹å®Œè¿™ç¯‡ï¼Œå†ä¹Ÿä¸æ€•å †æ’åºã€Top Kã€ä¸­ä½æ•°é—®é¢˜é¢è¯•äº†</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/å¤´æ¡æ­£åœ¨é¢çš„å“ˆå¸Œè¡¨é—®é¢˜.html" class="sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•ï¼šå¤´æ¡æ­£åœ¨é¢çš„å“ˆå¸Œè¡¨é—®é¢˜</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/å¦‚ä½•åˆ†æ-ç»Ÿè®¡ç®—æ³•çš„æ‰§è¡Œæ•ˆç‡å’Œèµ„æºæ¶ˆè€—.html" class="sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•1ï¼šå¦‚ä½•åˆ†æã€ç»Ÿè®¡ç®—æ³•çš„æ‰§è¡Œæ•ˆç‡å’Œèµ„æºæ¶ˆè€—ï¼Ÿ</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/å°ç™½éƒ½å¯ä»¥çœ‹æ‡‚çš„æ ‘ä¸äºŒå‰æ ‘.html" class="sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•7ï¼šå°ç™½éƒ½å¯ä»¥çœ‹æ‡‚çš„æ ‘ä¸äºŒå‰æ ‘</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/å¸¦ä½ å¿«é€Ÿå…¥é—¨å‰ç«¯ç®—æ³•.html" class="sidebar-link">10 é—® 10 ç­”ï¼Œå¸¦ä½ å¿«é€Ÿå…¥é—¨å‰ç«¯ç®—æ³•</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/å¸¸è§ç®—æ³•é¢˜åŠå®Œç¾é¢˜è§£.html" class="sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•ï¼šå¸¸è§ç®—æ³•é¢˜åŠå®Œç¾é¢˜è§£</a></li><li><a href="/algorithm/ç®—æ³•è¿›é˜¶/é“¾è¡¨åŸæ¥å¦‚æ­¤ç®€å•.html" class="sidebar-link">å‰ç«¯è¿›é˜¶ç®—æ³•4ï¼šé“¾è¡¨åŸæ¥å¦‚æ­¤ç®€å•(+leetcodeåˆ·é¢˜ï¼‰</a></li></ul></section></li><li><a href="/algorithm/è´ªå¿ƒ.html" class="sidebar-link">å‰ç«¯ä¹Ÿèƒ½å­¦ç®—æ³•ï¼šç”±æµ…å…¥æ·±è®²è§£è´ªå¿ƒç®—æ³•</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="å‰ç«¯è¿›é˜¶ç®—æ³•2-ä»chrome-v8æºç çœ‹javascriptæ•°ç»„-é™„èµ è…¾è®¯é¢è¯•é¢˜"><a href="#å‰ç«¯è¿›é˜¶ç®—æ³•2-ä»chrome-v8æºç çœ‹javascriptæ•°ç»„-é™„èµ è…¾è®¯é¢è¯•é¢˜" class="header-anchor">#</a> å‰ç«¯è¿›é˜¶ç®—æ³•2ï¼šä»Chrome V8æºç çœ‹JavaScriptæ•°ç»„(é™„èµ è…¾è®¯é¢è¯•é¢˜)</h1> <p>åŸåˆ› å‰ç«¯ç“¶å­å› å‰ç«¯ç“¶å­å› <em>2020-04-02</em></p> <h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="header-anchor">#</a> ç®€ä»‹</h3> <p>æ•°ç»„ã€é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—éƒ½æ˜¯çº¿æ€§è¡¨ï¼Œå®ƒè¡¨ç¤ºçš„ç»“æ„éƒ½æ˜¯ä¸€æ®µçº¿æ€§çš„ç»“æ„ï¼Œä¸ä¹‹å¯¹åº”çš„å°±æ˜¯éçº¿æ€§è¡¨ï¼Œä¾‹å¦‚æ ‘ã€å›¾ã€å †ç­‰ï¼Œå®ƒè¡¨ç¤ºçš„ç»“æ„éƒ½éçº¿æ€§ã€‚</p> <p>æœ¬èŠ‚ä¸»è¦ä»‹ç» JavaScript æ•°ç»„ï¼Œåœ¨å¼€å§‹æœ¬ç« èŠ‚å‰ï¼Œæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼š</p> <p>æˆ‘ä»¬çŸ¥é“åœ¨ JavaScript ä¸­ï¼Œå¯ä»¥åœ¨æ•°ç»„ä¸­ä¿å­˜ä¸åŒç±»å‹å€¼ï¼Œå¹¶ä¸”æ•°ç»„å¯ä»¥åŠ¨æ€å¢é•¿ï¼Œä¸åƒå…¶å®ƒè¯­è¨€ï¼Œä¾‹å¦‚ Cï¼Œåˆ›å»ºçš„æ—¶å€™è¦å†³å®šæ•°ç»„çš„å¤§å°ï¼Œå¦‚æœæ•°ç»„æ»¡äº†ï¼Œå°±è¦é‡æ–°ç”³è¯·å†…å­˜ç©ºé—´ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå–ƒï¼Ÿ</p> <p>æœ¬èŠ‚ä» Chrome v8 æºç è§’åº¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œåˆ†ä¸ºå››ä¸ªæ–¹é¢ï¼š</p> <ul><li>æ•°ç»„åŸºç¡€å…¥é—¨</li> <li>JavaScript ä¸­ï¼Œæ•°ç»„ä¸ºä»€ä¹ˆå¯ä»¥ä¿å­˜ä¸åŒç±»å‹ï¼Ÿ</li> <li>JavaScript ä¸­ï¼Œæ•°ç»„æ˜¯å¦‚ä½•å­˜å‚¨çš„å–ƒï¼Ÿ</li> <li>JavaScript ä¸­ï¼Œæ•°ç»„çš„åŠ¨æ€æ‰©å®¹ä¸å‡å®¹ï¼ˆ <code>FastElements</code> ï¼‰</li></ul> <p>ä¸‹é¢è¿›å…¥æ­£é¢˜å§ï¼ï¼ˆæ–‡æœ«æœ‰æƒŠå–œï¼‰ğŸ˜Š</p> <p>æƒ³è¦æ›´å¤šæ›´å¿«çš„å­¦ä¹ æœ¬ç³»åˆ—ï¼Œå¯ä»¥å…³æ³¨å…¬ä¼—å·ã€Œå‰ç«¯ç“¶å­å›ã€å’Œæˆ‘çš„ã€ŒGithubï¼šhttps://github.com/sisterAn/JavaScript-Algorithmsã€</p> <h3 id="ä¸€ã€æ•°ç»„-åŸºç¡€"><a href="#ä¸€ã€æ•°ç»„-åŸºç¡€" class="header-anchor">#</a> ä¸€ã€æ•°ç»„ï¼ˆåŸºç¡€ï¼‰</h3> <p>ä¸€ç§æœ€åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œæ¯ç§ç¼–ç¨‹è¯­è¨€éƒ½æœ‰ï¼Œå®ƒç¼–å·ä» 0 å¼€å§‹ï¼Œä»£è¡¨ä¸€ç»„è¿ç»­çš„å‚¨å­˜ç»“æ„ï¼Œç”¨æ¥å‚¨å­˜åŒä¸€ç§ç±»å‹çš„æ•°æ®ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>let arr = [1, 2, 3]
</code></pre></div><p>å®ƒçš„è¿™ç§ç‰¹å®šçš„å­˜å‚¨ç»“æ„ï¼ˆè¿ç»­å­˜å‚¨ç©ºé—´å­˜å‚¨åŒä¸€ç±»å‹æ•°æ®ï¼‰å†³å®šäº†ï¼š</p> <p><strong>ä¼˜ç‚¹</strong></p> <ul><li>éšæœºè®¿é—®ï¼šå¯ä»¥é€šè¿‡ä¸‹æ ‡éšæœºè®¿é—®æ•°ç»„ä¸­çš„ä»»æ„ä½ç½®ä¸Šçš„æ•°æ®</li></ul> <p><strong>ç¼ºç‚¹</strong></p> <ul><li>å¯¹æ•°æ®çš„åˆ é™¤å’Œæ’å…¥ä¸æ˜¯å¾ˆå‹å¥½</li></ul> <p><strong>æŸ¥æ‰¾ï¼š</strong> æ ¹æ®ä¸‹æ ‡éšæœºè®¿é—®çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼›</p> <p><strong>æ’å…¥æˆ–åˆ é™¤ï¼š</strong> æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼›</p> <p>åœ¨ JavaScript ä¸­çš„æ•°ç»„å‡ ä¹æ˜¯ä¸‡èƒ½çš„ï¼Œå®ƒä¸å…‰å¯ä»¥ä½œä¸ºä¸€ä¸ªæ™®é€šçš„æ•°ç»„ä½¿ç”¨ï¼Œå¯ä»¥ä½œä¸ºæ ˆæˆ–é˜Ÿåˆ—ä½¿ç”¨ã€‚</p> <p>æ•°ç»„ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>let array = [1, 2, 3]
</code></pre></div><p>æ ˆï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>let stack = [1, 2, 3]
// è¿›æ ˆ
stack.push(4)
// å‡ºæ ˆ
stcak.pop()
</code></pre></div><p>é˜Ÿåˆ—ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>let queue = [1, 2, 3]
// è¿›é˜Ÿ
queue.push(4)
// å‡ºé˜Ÿ
queue.shift()
</code></pre></div><h3 id="äºŒã€javascript-ä¸­-æ•°ç»„å¯ä»¥ä¿å­˜ä¸åŒç±»å‹å€¼"><a href="#äºŒã€javascript-ä¸­-æ•°ç»„å¯ä»¥ä¿å­˜ä¸åŒç±»å‹å€¼" class="header-anchor">#</a> äºŒã€JavaScript ä¸­ï¼Œæ•°ç»„å¯ä»¥ä¿å­˜ä¸åŒç±»å‹å€¼</h3> <p>çœ‹ä¸€ä¸‹ Chrome v8 æºç ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// The JSArray describes JavaScript Arrays
//  Such an array can be in one of two modes:
//    - fast, backing storage is a FixedArray and length &lt;= elements.length();
//       Please note: push and pop can be used to grow and shrink the array.
//    - slow, backing storage is a HashTable with numbers as keys.
class JSArray: public JSObject {
 public:
  // [length]: The length property.
  DECL_ACCESSORS(length, Object)
    
  // ...
   
  // Number of element slots to pre-allocate for an empty array.
  static const int kPreallocatedArrayElements = 4;
};
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>JSArray</code> æ˜¯ç»§æ‰¿è‡ª <code>JSObject</code> çš„ï¼Œæ‰€ä»¥åœ¨ JavaScript ä¸­ï¼Œæ•°ç»„å¯ä»¥æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œå†…éƒ¨ä¹Ÿæ˜¯ä»¥ key-value å½¢å¼å­˜å‚¨æ•°æ®ï¼Œæ‰€ä»¥ JavaScript ä¸­çš„æ•°ç»„å¯ä»¥å­˜æ”¾ä¸åŒç±»å‹çš„å€¼ã€‚</p> <h3 id="ä¸‰ã€javascript-ä¸­-æ•°ç»„çš„å­˜å‚¨"><a href="#ä¸‰ã€javascript-ä¸­-æ•°ç»„çš„å­˜å‚¨" class="header-anchor">#</a> ä¸‰ã€JavaScript ä¸­ï¼Œæ•°ç»„çš„å­˜å‚¨</h3> <div class="language- extra-class"><pre class="language-text"><code>// The JSArray describes JavaScript Arrays
//  Such an array can be in one of two modes:
//    - fast, backing storage is a FixedArray and length &lt;= elements.length();
//       Please note: push and pop can be used to grow and shrink the array.
//    - slow, backing storage is a HashTable with numbers as keys.
class JSArray: public JSObject {
 public:
  // [length]: The length property.
  DECL_ACCESSORS(length, Object)
    
  // ...
   
  // Number of element slots to pre-allocate for an empty array.
  static const int kPreallocatedArrayElements = 4;
};
</code></pre></div><p><code>JSArray</code> ç»§æ‰¿äº <code>JSObject</code> ï¼Œä»æ³¨é‡Šä¸Šçœ‹ï¼Œå®ƒæœ‰ä¸¤ç§å­˜å‚¨æ–¹å¼ï¼š</p> <ul><li>fastï¼šå­˜å‚¨ç»“æ„æ˜¯ <code>FixedArray</code> ï¼Œå¹¶ä¸”æ•°ç»„é•¿åº¦ <code>&lt;= elements.length()</code> ï¼Œ<code>push</code> æˆ– <code>pop</code> æ—¶å¯èƒ½ä¼šä¼´éšç€åŠ¨æ€æ‰©å®¹æˆ–å‡å®¹</li> <li>slowï¼šå­˜å‚¨ç»“æ„æ˜¯ <code>HashTable</code>ï¼ˆå“ˆå¸Œè¡¨ï¼‰ï¼Œå¹¶ä¸”æ•°ç»„ä¸‹æ ‡ä½œä¸º <code>key</code></li></ul> <p><code>fast</code> æ¨¡å¼ä¸‹æ•°ç»„åœ¨æºç é‡Œé¢å« <code>FastElements</code> ï¼Œè€Œ <code>slow</code> æ¨¡å¼ä¸‹çš„å«åš <code>SlowElements</code> ã€‚</p> <h4 id="_1-å¿«æ•°ç»„-fastelements"><a href="#_1-å¿«æ•°ç»„-fastelements" class="header-anchor">#</a> 1. å¿«æ•°ç»„ï¼ˆFastElementsï¼‰</h4> <p><code>FixedArray</code> æ˜¯ V8 å®ç°çš„ä¸€ä¸ªç±»ä¼¼äºæ•°ç»„çš„ç±»ï¼Œå®ƒè¡¨ç¤ºä¸€æ®µè¿ç»­çš„å†…å­˜ï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼•ç›´æ¥å®šä½ã€‚æ–°åˆ›å»ºçš„ç©ºæ•°ç»„é»˜è®¤å°±æ˜¯å¿«æ•°ç»„ã€‚å½“æ•°ç»„æ»¡ï¼ˆæ•°ç»„çš„é•¿åº¦è¾¾åˆ°æ•°ç»„åœ¨å†…å­˜ä¸­ç”³è¯·çš„å†…å­˜å®¹é‡æœ€å¤§å€¼ï¼‰çš„æ—¶å€™ï¼Œç»§ç»­ <code>push</code> æ—¶ï¼Œ <code>JSArray</code> ä¼šè¿›è¡ŒåŠ¨æ€çš„æ‰©å®¹ï¼Œä»¥å­˜å‚¨æ›´å¤šçš„å…ƒç´ ã€‚</p> <h4 id="_2-æ…¢æ•°ç»„-slowelements"><a href="#_2-æ…¢æ•°ç»„-slowelements" class="header-anchor">#</a> 2. æ…¢æ•°ç»„ï¼ˆSlowElementsï¼‰</h4> <p>æ…¢æ•°ç»„ä»¥å“ˆå¸Œè¡¨çš„å½¢å¼å­˜å‚¨åœ¨å†…å­˜ç©ºé—´é‡Œï¼Œå®ƒä¸éœ€è¦å¼€è¾Ÿè¿ç»­çš„å­˜å‚¨ç©ºé—´ï¼Œä½†éœ€è¦é¢å¤–ç»´æŠ¤ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œä¸å¿«æ•°ç»„ç›¸æ¯”ï¼Œæ€§èƒ½ç›¸å¯¹è¾ƒå·®ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>// src/objects/dictionary.h
class EXPORT_TEMPLATE_DECLARE(V8_EXPORT_PRIVATE) Dictionary
    : public HashTable&lt;Derived, Shape&gt; {
  using DerivedHashTable = HashTable&lt;Derived, Shape&gt;;

 public:
  using Key = typename Shape::Key;
  // Returns the value at entry.
  inline Object ValueAt(InternalIndex entry);
  inline Object ValueAt(const Isolate* isolate, InternalIndex entry);
  
  // ...
};
</code></pre></div><p>ä»æºç ä¸­å¯ä»¥çœ‹å‡ºï¼Œå®ƒçš„å†…éƒ¨å°±æ˜¯ä¸€ä¸ª HashTableã€‚</p> <h4 id="_3-ä»€ä¹ˆæ—¶å€™ä¼šä»-fast-è½¬å˜ä¸º-slow-å–ƒ"><a href="#_3-ä»€ä¹ˆæ—¶å€™ä¼šä»-fast-è½¬å˜ä¸º-slow-å–ƒ" class="header-anchor">#</a> 3. ä»€ä¹ˆæ—¶å€™ä¼šä» fast è½¬å˜ä¸º slow å–ƒï¼Ÿ</h4> <p>ä» Chrome V8 æºç ä¸Šçœ‹ï¼Œ</p> <div class="language- extra-class"><pre class="language-text"><code>// src/objects/js-objects.h
static const uint32_t kMaxGap = 1024;

// src/objects/dictionary.h
// JSObjects prefer dictionary elements if the dictionary saves this much
// memory compared to a fast elements backing store.
static const uint32_t kPreferFastElementsSizeFactor = 3;

// src/objects/js-objects-inl.h
// If the fast-case backing storage takes up much more memory than a dictionary
// backing storage would, the object should have slow elements.
// static
static inline bool ShouldConvertToSlowElements(uint32_t used_elements,
                                               uint32_t new_capacity) {
  uint32_t size_threshold = NumberDictionary::kPreferFastElementsSizeFactor *
                            NumberDictionary::ComputeCapacity(used_elements) *
                            NumberDictionary::kEntrySize;
  // å¿«æ•°ç»„æ–°å®¹é‡æ˜¯æ‰©å®¹åçš„å®¹é‡3å€ä¹‹å¤šæ—¶ï¼Œä¹Ÿä¼šè¢«è½¬æˆæ…¢æ•°ç»„
  return size_threshold &lt;= new_capacity;
}

static inline bool ShouldConvertToSlowElements(JSObject object,
                                               uint32_t capacity,
                                               uint32_t index,
                                               uint32_t* new_capacity) {
  STATIC_ASSERT(JSObject::kMaxUncheckedOldFastElementsLength &lt;=
                JSObject::kMaxUncheckedFastElementsLength);
  if (index &lt; capacity) {
    *new_capacity = capacity;
    return false;
  }
  // å½“åŠ å…¥çš„ç´¢å¼•å€¼ï¼ˆä¾‹å¦‚ä¾‹3ä¸­çš„2000ï¼‰æ¯”å½“å‰å®¹é‡capacity å¤§äºç­‰äº 1024æ—¶ï¼Œ
  // è¿”å›trueï¼Œè½¬ä¸ºæ…¢æ•°ç»„
  if (index - capacity &gt;= JSObject::kMaxGap) return true;
  *new_capacity = JSObject::NewElementsCapacity(index + 1);
  DCHECK_LT(index, *new_capacity);
  // TODO(ulan): Check if it works with young large objects.
  if (*new_capacity &lt;= JSObject::kMaxUncheckedOldFastElementsLength ||
      (*new_capacity &lt;= JSObject::kMaxUncheckedFastElementsLength &amp;&amp;
       ObjectInYoungGeneration(object))) {
    return false;
  }
  return ShouldConvertToSlowElements(object.GetFastElementsUsage(),
                                     *new_capacity);
}
</code></pre></div><p>æ‰€ä»¥ï¼Œå½“å¤„äºä»¥ä¸‹æƒ…å†µæ—¶ï¼Œå¿«æ•°ç»„ä¼šè¢«è½¬å˜ä¸ºæ…¢æ•°ç»„ï¼š</p> <ul><li>å½“åŠ å…¥çš„ç´¢å¼•å€¼ index æ¯”å½“å‰å®¹é‡ capacity å·®å€¼å¤§äºç­‰äº 1024 æ—¶ï¼ˆindex - capacity &gt;= 1024ï¼‰</li> <li>å¿«æ•°ç»„æ–°å®¹é‡æ˜¯æ‰©å®¹åçš„å®¹é‡ 3 å€ä¹‹å¤šæ—¶</li></ul> <p>ä¾‹å¦‚ï¼šå‘å¿«æ•°ç»„é‡Œå¢åŠ ä¸€ä¸ªå¤§ç´¢å¼•åŒç±»å‹å€¼</p> <div class="language- extra-class"><pre class="language-text"><code>var arr = [1, 2, 3]
arr[2000] = 10;
</code></pre></div><p>å½“å¾€ <code>arr</code> å¢åŠ ä¸€ä¸ª <code>2000</code> çš„ç´¢å¼•æ—¶ï¼Œ<code>arr</code> è¢«è½¬æˆæ…¢æ•°ç»„ã€‚èŠ‚çœäº†å¤§é‡çš„å†…å­˜ç©ºé—´ï¼ˆä»ç´¢å¼•ä¸º 2 åˆ°ç´¢å¼•ä¸º 2000ï¼‰ã€‚</p> <h4 id="_4-ä»€ä¹ˆæ—¶å€™ä¼šä»-slow-è½¬å˜ä¸º-fast-å–ƒ"><a href="#_4-ä»€ä¹ˆæ—¶å€™ä¼šä»-slow-è½¬å˜ä¸º-fast-å–ƒ" class="header-anchor">#</a> 4. ä»€ä¹ˆæ—¶å€™ä¼šä» slow è½¬å˜ä¸º fast å–ƒï¼Ÿ</h4> <p>æˆ‘ä»¬å·²ç»çŸ¥é“åœ¨ä»€ä¹ˆæ—¶å€™ä¼šå‡ºç°ç”±å¿«å˜æ…¢ï¼Œé‚£ç”±æ…¢å˜å¿«å°±å¾ˆç®€å•äº†</p> <div class="language- extra-class"><pre class="language-text"><code>static bool ShouldConvertToFastElements(JSObject object,
                                        NumberDictionary dictionary,
                                        uint32_t index,
                                        uint32_t* new_capacity) {
  // If properties with non-standard attributes or accessors were added, we
  // cannot go back to fast elements.
  if (dictionary.requires_slow_elements()) return false;
  // Adding a property with this index will require slow elements.
  if (index &gt;= static_cast&lt;uint32_t&gt;(Smi::kMaxValue)) return false;
  if (object.IsJSArray()) {
    Object length = JSArray::cast(object).length();
    if (!length.IsSmi()) return false;
    *new_capacity = static_cast&lt;uint32_t&gt;(Smi::ToInt(length));
  } else if (object.IsJSArgumentsObject()) {
    return false;
  } else {
    *new_capacity = dictionary.max_number_key() + 1;
  }
  *new_capacity = Max(index + 1, *new_capacity);
  uint32_t dictionary_size = static_cast&lt;uint32_t&gt;(dictionary.Capacity()) *
                             NumberDictionary::kEntrySize;
  // Turn fast if the dictionary only saves 50% space.
  return 2 * dictionary_size &gt;= *new_capacity;
}
</code></pre></div><p>å½“æ…¢æ•°ç»„çš„å…ƒç´ å¯å­˜æ”¾åœ¨å¿«æ•°ç»„ä¸­ä¸”é•¿åº¦åœ¨ smi ä¹‹é—´ä¸”ä»…èŠ‚çœäº†50%çš„ç©ºé—´ï¼Œåˆ™ä¼šè½¬å˜ä¸ºå¿«æ•°ç»„</p> <h3 id="å››ã€javascript-ä¸­-æ•°ç»„çš„åŠ¨æ€æ‰©å®¹ä¸å‡å®¹-fastelements"><a href="#å››ã€javascript-ä¸­-æ•°ç»„çš„åŠ¨æ€æ‰©å®¹ä¸å‡å®¹-fastelements" class="header-anchor">#</a> å››ã€JavaScript ä¸­ï¼Œæ•°ç»„çš„åŠ¨æ€æ‰©å®¹ä¸å‡å®¹ï¼ˆFastElementsï¼‰</h3> <p>é»˜è®¤ç©ºæ•°ç»„åˆå§‹åŒ–å¤§å°ä¸º <code>4</code> :</p> <div class="language- extra-class"><pre class="language-text"><code>// Number of element slots to pre-allocate for an empty array.
static const int kPreallocatedArrayElements = 4;
</code></pre></div><p>åœ¨ JavaScript ä¸­ï¼Œå½“æ•°ç»„æ‰§è¡Œ <code>push</code> æ“ä½œæ—¶ï¼Œä¸€æ—¦å‘ç°æ•°ç»„å†…å­˜ä¸è¶³ï¼Œå°†è¿›è¡Œæ‰©å®¹ã€‚</p> <p>åœ¨ Chrome æºç ä¸­ï¼Œ <code>push</code> çš„æ“ä½œæ˜¯ç”¨æ±‡ç¼–å®ç°çš„ï¼Œåœ¨ c++ é‡ŒåµŒå…¥çš„æ±‡ç¼–ï¼Œä»¥æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œå¹¶ä¸”åœ¨æ±‡ç¼–çš„åŸºç¡€ä¸Šç”¨ c++ å°è£…äº†ä¸€å±‚ï¼Œåœ¨ç¼–è¯‘æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šå°†è¿™äº› c++ ä»£ç è½¬æˆæ±‡ç¼–ä»£ç ã€‚</p> <p>è®¡ç®—æ–°å®¹é‡çš„å‡½æ•°ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// js-objects.h
static const uint32_t kMinAddedElementsCapacity = 16;

// code-stub-assembler.cc
Node* CodeStubAssembler::CalculateNewElementsCapacity(Node* old_capacity,
                                                      ParameterMode mode) {
  CSA_SLOW_ASSERT(this, MatchesParameterMode(old_capacity, mode));
  Node* half_old_capacity = WordOrSmiShr(old_capacity, 1, mode);
  Node* new_capacity = IntPtrOrSmiAdd(half_old_capacity, old_capacity, mode);
  Node* padding =
      IntPtrOrSmiConstant(JSObject::kMinAddedElementsCapacity, mode);
  return IntPtrOrSmiAdd(new_capacity, padding, mode);
}
</code></pre></div><p>æ‰€ä»¥æ‰©å®¹åæ–°å®¹é‡è®¡å…¬å¼ä¸ºï¼š</p> <blockquote><p>new_capacity = old_capacity /2 + old_capacity + 16</p></blockquote> <p>å³è€çš„å®¹é‡çš„ 1.5 å€åŠ ä¸Š 16 ã€‚åˆå§‹åŒ–ä¸º 4 ä¸ªï¼Œå½“ <code>push</code> ç¬¬ 5 ä¸ªçš„æ—¶å€™ï¼Œå®¹é‡å°†ä¼šå˜æˆï¼š</p> <blockquote><p>new_capacity = 4 / 2 + 4 + 16 = 22</p></blockquote> <p>æ¥ç€ç”³è¯·ä¸€å—è¿™ä¹ˆå¤§çš„å†…å­˜ï¼ŒæŠŠè€çš„æ•°æ®æ‹·è¿‡å»ï¼ŒæŠŠæ–°å…ƒç´ æ”¾åœ¨å½“å‰ length ä½ç½®ï¼Œç„¶åå°†æ•°ç»„çš„ length + 1ï¼Œå¹¶è¿”å› lengthã€‚</p> <p>æ‰€ä»¥ï¼Œæ‰©å®¹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p> <ul><li><code>push</code> æ“ä½œæ—¶ï¼Œå‘ç°æ•°ç»„å†…å­˜ä¸è¶³</li> <li>ç”³è¯· new_capacity = old_capacity /2 + old_capacity + 16 é‚£ä¹ˆé•¿åº¦çš„å†…å­˜ç©ºé—´</li> <li>å°†æ•°ç»„æ‹·è´åˆ°æ–°å†…å­˜ä¸­</li> <li>æŠŠæ–°å…ƒç´ æ”¾åœ¨å½“å‰ length ä½ç½®</li> <li>æ•°ç»„çš„ length + 1</li> <li>è¿”å› length</li></ul> <p>æ•´ä¸ªè¿‡ç¨‹ï¼Œç”¨æˆ·æ˜¯æ— æ„ŸçŸ¥çš„ï¼Œä¸åƒ Cï¼Œéœ€ç”¨ç”¨æˆ·æ‰‹åŠ¨ç”³è¯·å†…å­˜ç©ºé—´ã€‚</p> <p>å½“æ•°ç»„æ‰§è¡Œ <code>pop</code> æ“ä½œæ—¶ï¼Œä¼šåˆ¤æ–­ <code>pop</code> åæ•°ç»„çš„å®¹é‡ï¼Œæ˜¯å¦éœ€è¦è¿›è¡Œå‡å®¹ã€‚</p> <p>ä¸åŒäºæ•°ç»„çš„ <code>push</code> ä½¿ç”¨æ±‡ç¼–å®ç°çš„ï¼Œ <code>pop</code> ä½¿ç”¨ c++ å®ç°çš„ã€‚</p> <p>åˆ¤æ–­æ˜¯å¦è¿›è¡Œå‡å®¹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>if (2 * length &lt;= capacity) {
  // If more than half the elements won't be used, trim the array.
  isolate-&gt;heap()-&gt;RightTrimFixedArray(*backing_store, capacity - length);
} else {
  // Otherwise, fill the unused tail with holes.
  BackingStore::cast(*backing_store)-&gt;FillWithHoles(length, old_length);
}
</code></pre></div><p>æ‰€ä»¥ï¼Œå½“æ•°ç»„ <code>pop</code> åï¼Œå¦‚æœæ•°ç»„å®¹é‡å¤§äºç­‰äº length çš„ 2 å€ï¼Œåˆ™è¿›è¡Œå®¹é‡è°ƒæ•´ï¼Œä½¿ç”¨ <code>RightTrimFixedArray</code> å‡½æ•°ï¼Œè®¡ç®—å‡ºéœ€è¦é‡Šæ”¾çš„ç©ºé—´å¤§å°ï¼Œåšå¥½æ ‡è®°ï¼Œç­‰å¾… GC å›æ”¶ï¼›å¦‚æœæ•°ç»„å®¹é‡å°äº length çš„ 2 å€ï¼Œåˆ™ç”¨ holes å¯¹è±¡å¡«å……ã€‚</p> <p>æ‰€ä»¥ï¼Œå‡å®¹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p> <ul><li><code>pop</code> æ“ä½œæ—¶ï¼Œè·å–æ•°ç»„ <code>length</code></li> <li>è·å– <code>length - 1</code> ä¸Šçš„å…ƒç´ ï¼ˆè¦åˆ é™¤çš„å…ƒç´ ï¼‰</li> <li>æ•°ç»„ <code>length - 1</code></li> <li>åˆ¤æ–­æ•°ç»„çš„æ€»å®¹é‡æ˜¯å¦å¤§äºç­‰äº length - 1 çš„ 2 å€</li> <li>æ˜¯çš„è¯ï¼Œä½¿ç”¨ <code>RightTrimFixedArray</code> å‡½æ•°ï¼Œè®¡ç®—å‡ºéœ€è¦é‡Šæ”¾çš„ç©ºé—´å¤§å°ï¼Œå¹¶åšå¥½æ ‡è®°ï¼Œç­‰å¾… <code>GC</code> å›æ”¶</li> <li>ä¸æ˜¯çš„è¯ï¼Œç”¨ <code>holes</code> å¯¹è±¡å¡«å……</li> <li>è¿”å›è¦åˆ é™¤çš„å…ƒç´ </li></ul> <h3 id="äº”ã€è§£ç­”å¼€ç¯‡é—®é¢˜"><a href="#äº”ã€è§£ç­”å¼€ç¯‡é—®é¢˜" class="header-anchor">#</a> äº”ã€è§£ç­”å¼€ç¯‡é—®é¢˜</h3> <p>JavaScript ä¸­ï¼Œ <code>JSArray</code> ç»§æ‰¿è‡ª <code>JSObject</code> ï¼Œæˆ–è€…è¯´å®ƒå°±æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œå†…éƒ¨æ˜¯ä»¥ key-value å½¢å¼å­˜å‚¨æ•°æ®ï¼Œæ‰€ä»¥ JavaScript ä¸­çš„æ•°ç»„å¯ä»¥å­˜æ”¾ä¸åŒç±»å‹çš„å€¼ã€‚å®ƒæœ‰ä¸¤ç§å­˜å‚¨æ–¹å¼ï¼Œå¿«æ•°ç»„ä¸æ…¢æ•°ç»„ï¼Œåˆå§‹åŒ–ç©ºæ•°ç»„æ—¶ï¼Œä½¿ç”¨å¿«æ•°ç»„ï¼Œå¿«æ•°ç»„ä½¿ç”¨è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå½“æ•°ç»„é•¿åº¦è¾¾åˆ°æœ€å¤§æ—¶ï¼Œ<code>JSArray</code> ä¼šè¿›è¡ŒåŠ¨æ€çš„æ‰©å®¹ï¼Œä»¥å­˜å‚¨æ›´å¤šçš„å…ƒç´ ï¼Œç›¸å¯¹æ…¢æ•°ç»„ï¼Œæ€§èƒ½è¦å¥½å¾—å¤šã€‚å½“æ•°ç»„ä¸­ <code>hole</code> å¤ªå¤šæ—¶ï¼Œä¼šè½¬å˜æˆæ…¢æ•°ç»„ï¼Œå³ä»¥å“ˆå¸Œè¡¨çš„æ–¹å¼ï¼ˆ key-value çš„å½¢å¼ï¼‰å­˜å‚¨æ•°æ®ï¼Œä»¥èŠ‚çœå†…å­˜ç©ºé—´ã€‚</p> <h3 id="å…­ã€æœ€åé™„èµ ä¸€é“å‰ç«¯é¢è¯•é¢˜-è…¾è®¯-æ•°ç»„æ‰å¹³åŒ–ã€å»é‡ã€æ’åº"><a href="#å…­ã€æœ€åé™„èµ ä¸€é“å‰ç«¯é¢è¯•é¢˜-è…¾è®¯-æ•°ç»„æ‰å¹³åŒ–ã€å»é‡ã€æ’åº" class="header-anchor">#</a> å…­ã€æœ€åé™„èµ ä¸€é“å‰ç«¯é¢è¯•é¢˜ï¼ˆè…¾è®¯ï¼‰ï¼šæ•°ç»„æ‰å¹³åŒ–ã€å»é‡ã€æ’åº</h3> <p>å…³äº <code>Array</code> çš„å±æ€§ã€æ–¹æ³•è¿™é‡Œä¸å†åšä»‹ç»ï¼Œè¯¦çœ‹ MDN Array ã€‚</p> <p>é¢è¯•é¢˜ï¼š</p> <blockquote><p>å·²çŸ¥å¦‚ä¸‹æ•°ç»„ï¼švar arr = [ [1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14] ] ] ], 10];</p> <p>ç¼–å†™ä¸€ä¸ªç¨‹åºå°†æ•°ç»„æ‰å¹³åŒ–å»å¹¶é™¤å…¶ä¸­é‡å¤éƒ¨åˆ†æ•°æ®ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå‡åºä¸”ä¸é‡å¤çš„æ•°ç»„</p></blockquote> <p>ç­”æ¡ˆï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>var arr = [ [1, 2, 2], [3, 4, 5, 5], [6, 7, 8, 9, [11, 12, [12, 13, [14] ] ] ], 10]
// æ‰å¹³åŒ–
let flatArr = arr.flat(4)
// å»é‡
let disArr = Array.from(new Set(flatArr))
// æ’åº
let result = disArr.sort(function(a, b) {
    return a-b
})
console.log(result)
// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
</code></pre></div><p>å…³äº Set è¯·æŸ¥é˜… Setã€WeakSetã€MapåŠWeakMap</p> <p>å‚è€ƒé“¾æ¥ï¼š</p> <p>æ¢ç©¶JS V8å¼•æ“ä¸‹çš„â€œæ•°ç»„â€åº•å±‚å®ç°</p> <p>ä»Chromeæºç çœ‹JS Arrayçš„å®ç°</p> <h3 id="ä¸ƒã€è®¤è¯†æ›´å¤šçš„å‰ç«¯é“å‹-ä¸€èµ·è¿›é˜¶å‰ç«¯å¼€å‘"><a href="#ä¸ƒã€è®¤è¯†æ›´å¤šçš„å‰ç«¯é“å‹-ä¸€èµ·è¿›é˜¶å‰ç«¯å¼€å‘" class="header-anchor">#</a> ä¸ƒã€è®¤è¯†æ›´å¤šçš„å‰ç«¯é“å‹ï¼Œä¸€èµ·è¿›é˜¶å‰ç«¯å¼€å‘</h3> <p>å‰ç«¯ç®—æ³•é›†è®­è¥ç¬¬ä¸€æœŸå¼€è¥å•¦ğŸ‰ğŸ‰ğŸ‰</p> <p>åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥å’Œå¿—åŒé“åˆçš„å‰ç«¯æœ‹å‹ä»¬ä¸€èµ·è¿›é˜¶å‰ç«¯ç®—æ³•ï¼Œä»0åˆ°1æ„å»ºå®Œæ•´çš„æ•°æ®ç»“æ„ä¸ç®—æ³•ä½“ç³»ã€‚</p> <p>æ‰«ç åŠ å…¥ã€å‰ç«¯ç®—æ³•äº¤æµç¾¤äº¤æµç¾¤</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">5/8/2024, 3:01:19 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/algorithm/ç®€å•å¤ä¹ ä¸‹å‰ç«¯ç®—æ³•å¤æ‚åº¦ç›¸å…³çš„çŸ¥è¯†.html" class="prev">
        ç®€å•å¤ä¹ ä¸‹å‰ç«¯ç®—æ³•å¤æ‚åº¦ç›¸å…³çš„çŸ¥è¯†
      </a></span> <span class="next"><a href="/algorithm/ç®—æ³•è¿›é˜¶/DIffç®—æ³•çœ‹ä¸æ‡‚å°±ä¸€èµ·æ¥é”¤æˆ‘.html">
        DIffç®—æ³•çœ‹ä¸æ‡‚å°±ä¸€èµ·æ¥é”¤æˆ‘
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.950eebbc.js" defer></script><script src="/assets/js/2.57da4f88.js" defer></script><script src="/assets/js/1.a76cc220.js" defer></script><script src="/assets/js/29.49b5374e.js" defer></script>
  </body>
</html>
